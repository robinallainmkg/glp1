# üè• GLP-1 France - Site d'Information M√©dicale

> **Branche de r√©f√©rence : `production`**
> 
> Toutes les op√©rations de d√©veloppement, de build et de d√©ploiement doivent √™tre effectu√©es sur la branche `production`. Cette branche correspond toujours √† la version en ligne du site. Ne pas utiliser la branche `main` comme r√©f√©rence.

## üìã APER√áU DU PROJET

Site web d'information sp√©cialis√© sur les **agonistes du r√©cepteur GLP-1** en France, d√©velopp√© avec **Astro.js**. 

### Statistiques actuelles (Ao√ªt 2025)
- **238 articles** r√©partis en 9 collections th√©matiques
- **152 pages** g√©n√©r√©es en statique (build r√©cent)
- **Dashboard d'administration** avec analyse SEO et donn√©es utilisateurs
- **Syst√®me de collecte de donn√©es** (contact, newsletter, guide)
- **APIs TypeScript** s√©curis√©es pour la gestion des donn√©es
- **Syst√®me de maillage interne** optimis√© pour le SEO
- **Score SEO moyen** : En cours d'optimisation vers 80+/100

## üéØ OBJECTIFS

### Principal
Informer et accompagner les patients sur les traitements GLP-1 en France

### Secondaires
- **SEO** : Positionnement sur les mots-cl√©s m√©dicaux strat√©giques
- **Mon√©tisation** : Pr√©paration pour l'affiliation (pharmacies, compl√©ments)
- **Autorit√©** : R√©f√©rence francophone sur les GLP-1

### üßπ √âtat du Nettoyage (Ao√ªt 2025)
- ‚úÖ **Tous les H1 markdown supprim√©s** (238/238 articles)
- ‚úÖ **Sections vides/g√©n√©riques nettoy√©es** 
- ‚úÖ **Dashboard admin optimis√©** (2 onglets : Articles + Roadmap)
- ‚úÖ **Architecture des layouts coh√©rente** (H1 auto-inject√©)
- ‚úÖ **Scripts de maintenance document√©s**

### üìä Syst√®me de Donn√©es Utilisateurs (NOUVEAU - Ao√ªt 2025)
- ‚úÖ **Dashboard admin utilisateurs** : https://glp1-france.fr/admin-user-data/
- ‚úÖ **APIs TypeScript s√©curis√©es** (contact, guide, admin)
- ‚úÖ **Base de donn√©es JSON** pour les interactions utilisateurs
- ‚úÖ **Formulaires optimis√©s** avec autocomplete et validation
- ‚úÖ **Tracking des sources** d'inscription newsletter
- ‚úÖ **Export CSV** des donn√©es pour analyse

## üöÄ Technologies

- **Framework**: Astro 4.x
- **Styles**: CSS personnalis√© avec variables CSS
- **Scripts**: Node.js pour la g√©n√©ration et le nettoyage de contenu
- **D√©ploiement**: Compatible avec Vercel, Netlify, GitHub Pages

## üìã Pr√©requis

- Node.js 18+ 
- npm ou yarn
- Git

## üõ†Ô∏è Installation

```bash
# Cloner le projet
git clone https://github.com/robinallainmkg/glp1.git
cd glp1

# Basculer sur la branche de production (obligatoire)
git checkout production

# Installer les d√©pendances
npm install

# Nettoyer et optimiser tous les articles (IMPORTANT)
node scripts/clean-definitive.mjs

# G√©n√©rer l'audit SEO et pertinence
node scripts/audit-pertinence-content.mjs

# Lancer le serveur de d√©veloppement
npm run dev
```

> **‚ö†Ô∏è IMPORTANT - LOGIQUE DES TITRES H1** : 
> Les articles markdown ne doivent **PAS** contenir de H1 (`# titre`). 
> Le layout `ArticleLayout.astro` injecte automatiquement le H1 depuis le frontmatter `title`.
> Les articles commencent directement par du contenu et des H2 (`## section`).

## üìÇ Structure du Projet

```
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ layouts/          # Layouts Astro
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArticleLayout.astro  # Layout principal des articles
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BaseLayout.astro     # Layout de base
‚îÇ   ‚îú‚îÄ‚îÄ pages/           # Pages du site
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin-dashboard.astro # Dashboard d'administration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...         # Pages statiques et dynamiques
‚îÇ   ‚îú‚îÄ‚îÄ styles/          # CSS global et th√®mes
‚îÇ   ‚îî‚îÄ‚îÄ content/         # Articles markdown (238 articles)
‚îÇ       ‚îú‚îÄ‚îÄ medicaments-glp1/    # 45 articles
‚îÇ       ‚îú‚îÄ‚îÄ glp1-perte-de-poids/ # 42 articles
‚îÇ       ‚îú‚îÄ‚îÄ effets-secondaires-glp1/ # 38 articles
‚îÇ       ‚îî‚îÄ‚îÄ ...          # 7 autres collections
‚îú‚îÄ‚îÄ data/                # Base de donn√©es JSON
‚îÇ   ‚îú‚îÄ‚îÄ articles-database.json   # Index complet des articles
‚îÇ   ‚îú‚îÄ‚îÄ collections.json         # Configuration des collections
‚îÇ   ‚îú‚îÄ‚îÄ authors-testimonials.json # T√©moignages et auteurs
‚îÇ   ‚îú‚îÄ‚îÄ contact-submissions.json  # Soumissions de contact (NOUVEAU)
‚îÇ   ‚îú‚îÄ‚îÄ newsletter-subscribers.json # Inscrits newsletter (NOUVEAU)
‚îÇ   ‚îî‚îÄ‚îÄ guide-downloads.json      # T√©l√©chargements guide (NOUVEAU)
‚îú‚îÄ‚îÄ scripts/             # Scripts d'optimisation
‚îÇ   ‚îú‚îÄ‚îÄ clean-definitive.mjs     # Nettoyage H1 et sections vides
‚îÇ   ‚îú‚îÄ‚îÄ audit-pertinence-content.mjs # Audit SEO et √©ditorial
‚îÇ   ‚îú‚îÄ‚îÄ seo-audit-global.mjs     # Analyse SEO strat√©gique
‚îÇ   ‚îî‚îÄ‚îÄ ...             # 40+ scripts d'automatisation
‚îú‚îÄ‚îÄ public/              # Assets statiques
‚îî‚îÄ‚îÄ dist/               # Build de production
```

### üé® Architecture des Layouts

Le site utilise une **architecture de layouts hi√©rarchique** :

#### üìÑ BaseLayout.astro
- **R√¥le** : Layout fondamental avec HTML, HEAD, navigation, footer
- **Usage** : Pages statiques, pages de collection (index), pages institutionnelles
- **Contient** :
  - Header avec navigation et recherche
  - M√©tadonn√©es SEO (Open Graph, Twitter Cards)
  - CSS global et Google Analytics
  - Footer et scripts communs
- **Utilis√© par** : `index.astro`, pages `/collection/index.astro`, pages sp√©ciales

#### üìñ ArticleLayout.astro  
- **R√¥le** : Layout sp√©cialis√© pour les articles individuels
- **Usage** : Articles de contenu (fichiers markdown des collections)
- **H√©rite de** : `BaseLayout.astro` (composition)
- **Fonctionnalit√©s sp√©cifiques** :
  - **üçû Fil d'Ariane** : Navigation hi√©rarchique automatique
  - **üé® H1 stylis√©** : Inject√© depuis le frontmatter `title` avec gradient th√©matique
  - **üìä M√©tadonn√©es riches** : Auteur, temps de lecture, date, cat√©gorie
  - **üéØ Th√®mes adaptatifs** : Couleurs selon la collection (medical, cost, research...)
  - **üì± Design responsive** : Optimis√© pour mobile et desktop
  - **üîó Liens internes** : Navigation entre articles connexes

#### üé® Th√®mes ArticleLayout Disponibles
```javascript
// Configurations pr√©d√©finies pour chaque type de contenu
'weight-loss'   ‚Üí ‚öñÔ∏è  Vert     (Perte de poids)
'medical'       ‚Üí üíä  Bleu     (M√©dicaments)  
'cost'          ‚Üí üí∞  Jaune    (Prix/Co√ªts)
'side-effects'  ‚Üí ‚ö†Ô∏è  Rouge    (Effets secondaires)
'research'      ‚Üí üî¨  Indigo   (Recherche scientifique)
'diabetes'      ‚Üí ü©∫  Violet   (Diab√®te)
'nutrition'     ‚Üí ü•ó  Orange   (R√©gime/Nutrition)
'alternatives'  ‚Üí üå±  Cyan     (Alternatives naturelles)
'experts'       ‚Üí üë®‚Äç‚öïÔ∏è Teal     (M√©decins/Experts)
```

#### üîÄ R√®gles d'Usage
```
Pages Statiques     ‚Üí  BaseLayout      (ex: accueil, pages collection)
Articles Markdown   ‚Üí  ArticleLayout   (ex: tous les contenus des dossiers src/content/)
```

#### ‚ö†Ô∏è R√®gle Importante
Les fichiers markdown ne doivent **JAMAIS** contenir de `# H1` - le titre est automatiquement inject√© par `ArticleLayout` depuis le frontmatter.

---

## üìä Syst√®me de Donn√©es Utilisateurs

### üéØ Vue d'ensemble
Syst√®me complet de collecte et d'analyse des interactions utilisateurs d√©ploy√© en ao√ªt 2025.

### üîß Composants

#### Dashboard Admin
- **URL** : https://glp1-france.fr/admin-user-data/
- **Fichier** : `src/pages/admin-user-data.astro`
- **Authentification** : admin/admin123
- **Fonctionnalit√©s** :
  - Statistiques en temps r√©el
  - Liste des utilisateurs avec source
  - Export CSV des donn√©es
  - Graphiques de tendances

#### APIs TypeScript
```typescript
// Contact avec newsletter
POST /api/contact
// Guide avec pr√©f√©rences
POST /api/guide-beauty  
// Donn√©es admin (auth requis)
GET /api/admin-data
```

#### Base de donn√©es JSON
- `data/contact-submissions.json` - Messages de contact
- `data/newsletter-subscribers.json` - Inscrits newsletter avec source
- `data/guide-downloads.json` - T√©l√©chargements avec pr√©f√©rences

#### Formulaires optimis√©s
- **Contact** : https://glp1-france.fr/contact/
- **Guide** : https://glp1-france.fr/guide-beaute-perte-de-poids-glp1/
- Autocomplete activ√©, validation en temps r√©el
- Int√©gration newsletter automatique

### üìà Donn√©es collect√©es
- Inscriptions newsletter par source (contact/guide/direct)
- Messages de contact avec opt-in newsletter
- Pr√©f√©rences utilisateur (pr√©occupations beaut√©/sant√©)
- Horodatage pr√©cis de toutes les interactions

### üîí S√©curit√©
- Validation email c√¥t√© serveur
- Protection CORS sur les APIs
- Authentification basique pour l'admin
- Sanitisation des donn√©es d'entr√©e

> **Documentation compl√®te** : [docs/SYSTEME_DONNEES_UTILISATEURS.md](./docs/SYSTEME_DONNEES_UTILISATEURS.md)

---

## üîß Commandes

```bash
# D√©veloppement
npm run dev

# Build de production
npm run build

# Preview du build
npm run preview

# ===== SCRIPTS DE NETTOYAGE =====

# Nettoyage complet des articles (supprime H1, sections vides)
node scripts/clean-definitive.mjs

# Audit de pertinence √©ditoriale et SEO
node scripts/audit-pertinence-content.mjs

# Analyse SEO strat√©gique avanc√©e
node scripts/seo-audit-global.mjs

# ===== SCRIPTS DE G√âN√âRATION =====

# G√©n√©ration de la base de donn√©es d'articles
node scripts/generate-database-v2.mjs

# Application des prompts d'am√©lioration
npm run apply:prompt

# Enrichissement des articles courts
node scripts/enrich-short-articles.mjs
```

## üé® Fonctionnalit√©s

- **Recherche avanc√©e** avec suggestions et pr√©visualisation
- **Syst√®me d'auteurs** sp√©cialis√©s par domaine
- **T√©moignages** avec conseils beaut√©
- **Dashboard admin** pour la gestion des articles
- **Design responsive** et cartes d'articles interactives
- **SEO optimis√©** avec m√©tadonn√©es dynamiques

## üë• √âquipe d'Experts

- **Dr. Claire Morel** - M√©decin nutritionniste
- **Julien Armand** - Journaliste sant√© & bien-√™tre  
- **√âlodie Carpentier** - Sp√©cialiste cosm√©tique & dermo-soins
- **Marc Delattre** - R√©dacteur sport & forme

## üîê Administration

Acc√®s admin via `/admin-login/` avec authentification par session.

## üöÄ D√âPLOIEMENT

### Plateformes Support√©es

#### üñ•Ô∏è **macOS/Linux** : D√©ploiement Automatique SSH

```bash
# Build et d√©ploiement en une commande
npm run build
node deploy-auto.js
```

**D√©tails** :
- Utilise `rsync` + `sshpass` pour un d√©ploiement rapide
- Supprime automatiquement les anciens fichiers
- Synchronisation compl√®te du dossier `dist/`
- Connexion SSH directe au serveur Hostinger

#### ü™ü **Windows** : D√©ploiement PowerShell 

```powershell
# Build et d√©ploiement PowerShell
npm run build
.\deploy-auto.ps1
```

**D√©tails** :
- Script PowerShell optimis√© pour Windows
- Support SFTP/SCP via WinSCP ou alternatives
- Gestion des permissions Windows
- Configuration automatique des credentials

#### üìÅ **D√©ploiement Manuel** (Toutes plateformes)

```bash
# G√©n√©rer le build
npm run build

# Ouvrir le dossier dist pour upload manuel
node deploy-manual.js
```

**Instructions SFTP** :
- **Host** : 147.79.98.140:65002
- **Username** : u403023291  
- **R√©pertoire cible** : `domains/glp1-france.fr/public_html/`
- **M√©thode** : FileZilla, WinSCP, ou client SFTP

### Configuration Serveur

#### Hostinger SSH/SFTP
```bash
Host: 147.79.98.140
Port: 65002
Username: u403023291
Target: domains/glp1-france.fr/public_html/
Protocol: SSH/SFTP
```

#### Commandes de Build

```bash
# Build optimis√© pour production
npm run build

# Preview du build en local
npm run preview

# Audit final avant d√©ploiement
npm run check
```

### ‚úÖ Checklist D√©ploiement

- [ ] `npm run build` r√©ussi sans erreurs
- [ ] V√©rification du dashboard admin (`/admin-dashboard`)
- [ ] Test des URLs critiques (collections, articles)
- [ ] Validation du sitemap (`/sitemap.xml`)
- [ ] Upload des fichiers via m√©thode appropri√©e √† la plateforme
- [ ] Test du site en production : https://glp1-france.fr

### üõçÔ∏è Affiliation Shopify Collabs (Ao√ªt 2025)
- ‚úÖ **Partenaire Talika** : Bust Phytoserum (raffermissant post-GLP1)
- ‚úÖ **Code promo** : `GLP1` (-10%)
- ‚úÖ **URL track√©e** : talika.fr/GLP1
- ‚úÖ **Placement intelligent** : Apr√®s 2 paragraphes dans articles pertinents
- ‚úÖ **Design optimis√©** : Badge, pricing et CTA sans doublons