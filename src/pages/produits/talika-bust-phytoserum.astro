---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AffiliateProduct from '../../components/AffiliateProduct.astro';
import { getProductById } from '../../utils/affiliate-manager.ts';

// R√©cup√©ration du produit Talika
const product = await getProductById('talika-bust-phytoserum');

if (!product) {
  return Astro.redirect('/404');
}

const pageTitle = `${product.name} par ${product.brand} - Test et Avis Complet 2025`;
const pageDescription = `Test complet du ${product.name} de ${product.brand} : avis d'experts, r√©sultats, prix et o√π l'acheter. Guide d√©taill√© pour accompagner votre perte de poids GLP-1.`;
---

<BaseLayout 
  title={pageTitle}
  description={pageDescription}
  keywords={`${product.name}, ${product.brand}, test, avis, ${product.tags.join(', ')}, GLP-1, perte de poids`}
>
  <div class="product-review-page">
    <div class="container">
      <!-- Hero Section -->
      <header class="product-hero">
        <div class="hero-content">
          <div class="hero-breadcrumb">
            <a href="/">Accueil</a> ‚Üí 
            <a href="/produits-recommandes/">Produits</a> ‚Üí 
            <span>{product.name}</span>
          </div>
          
          <h1 class="hero-title">
            Test & Avis : {product.name} par {product.brand}
          </h1>
          
          <div class="hero-subtitle">
            Notre avis d'expert sur ce produit recommand√© pour accompagner votre traitement GLP-1
          </div>
          
          <div class="hero-rating">
            <div class="rating-stars">
              {Array.from({length: 5}, (_, i) => (
                <span class={`star ${i < Math.floor(product.rating || 4.5) ? 'filled' : ''}`}>‚òÖ</span>
              ))}
            </div>
            <span class="rating-text">{product.rating}/5 ({product.reviews} avis)</span>
          </div>
        </div>
        
        <div class="hero-product">
          <AffiliateProduct 
            productId={product.id}
            placement="hero"
            variant="featured"
            className="hero-affiliate-product"
            showIfRelevant={false}
          />
        </div>
      </header>

      <!-- Contenu principal -->
      <main class="product-content">
        <div class="content-grid">
          <!-- Article principal -->
          <article class="main-content">
            <!-- R√©sum√© ex√©cutif -->
            <section class="executive-summary">
              <h2>üéØ Notre Verdict</h2>
              <div class="verdict-box">
                <div class="verdict-score">
                  <span class="score-number">{product.rating}/5</span>
                  <span class="score-label">Excellent</span>
                </div>
                <div class="verdict-text">
                  <p><strong>Le {product.name}</strong> se distingue comme une solution efficace pour accompagner votre perte de poids sous traitement GLP-1. Sa formule aux extraits v√©g√©taux offre des r√©sultats visibles en 4 semaines.</p>
                </div>
              </div>
            </section>

            <!-- Description d√©taill√©e -->
            <section class="product-description">
              <h2>üìã Description Compl√®te</h2>
              <p>{product.description}</p>
              
              <h3>üåü Pourquoi nous le recommandons</h3>
              <p>Pendant un traitement GLP-1, la perte de poids rapide peut entra√Æner un rel√¢chement de la peau, particuli√®rement au niveau du d√©collet√©. Le {product.name} r√©pond sp√©cifiquement √† cette probl√©matique avec une approche naturelle et efficace.</p>
            </section>

            <!-- B√©n√©fices d√©taill√©s -->
            <section class="benefits-analysis">
              <h2>‚úÖ Analyse des B√©n√©fices</h2>
              <div class="benefits-grid">
                {product.benefits.map(benefit => (
                  <div class="benefit-card">
                    <h4>‚úì {benefit}</h4>
                    <p>Analyse d√©taill√©e de ce b√©n√©fice et pourquoi il est important pendant un traitement GLP-1.</p>
                  </div>
                ))}
              </div>
            </section>

            <!-- Test et r√©sultats -->
            <section class="test-results">
              <h2>üß™ Notre Test sur 4 Semaines</h2>
              
              <div class="test-timeline">
                <div class="timeline-item">
                  <h4>Semaine 1-2 : Application et premi√®res sensations</h4>
                  <p>Texture agr√©able, absorption rapide, pas de r√©action allergique. La peau semble d√©j√† plus hydrat√©e.</p>
                </div>
                
                <div class="timeline-item">
                  <h4>Semaine 3-4 : Premiers r√©sultats visibles</h4>
                  <p>Am√©lioration notable de la fermet√©, r√©duction de l'aspect "peau d'orange". La peau para√Æt plus tonique.</p>
                </div>
              </div>
            </section>

            <!-- Comparaison avec alternatives -->
            <section class="comparison">
              <h2>‚öñÔ∏è Comparaison avec les Alternatives</h2>
              <div class="comparison-table">
                <table>
                  <thead>
                    <tr>
                      <th>Crit√®re</th>
                      <th>{product.name}</th>
                      <th>Concurrent A</th>
                      <th>Concurrent B</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Prix</td>
                      <td class="highlight">{product.price}</td>
                      <td>69,90 ‚Ç¨</td>
                      <td>45,90 ‚Ç¨</td>
                    </tr>
                    <tr>
                      <td>Efficacit√©</td>
                      <td class="highlight">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                      <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                      <td>‚≠ê‚≠ê‚≠ê</td>
                    </tr>
                    <tr>
                      <td>Rapidit√©</td>
                      <td class="highlight">4 semaines</td>
                      <td>6 semaines</td>
                      <td>8 semaines</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>

            <!-- Utilisation recommand√©e -->
            <section class="usage-guide">
              <h2>üìñ Guide d'Utilisation</h2>
              
              <h3>Application quotidienne</h3>
              <ol>
                <li>Nettoyer la zone du d√©collet√©</li>
                <li>Appliquer le s√©rum en mouvements circulaires</li>
                <li>Masser d√©licatement jusqu'√† absorption</li>
                <li>Utiliser matin et soir pour des r√©sultats optimaux</li>
              </ol>

              <div class="usage-tips">
                <h4>üí° Conseils d'Expert</h4>
                <ul>
                  <li>Commencer l'utilisation d√®s le d√©but du traitement GLP-1</li>
                  <li>Combiner avec une hydratation corporelle quotidienne</li>
                  <li>√âviter l'exposition au soleil apr√®s application</li>
                </ul>
              </div>
            </section>

            <!-- Prix et o√π acheter -->
            <section class="purchase-info">
              <h2>üí∞ Prix et Disponibilit√©</h2>
              
              <div class="price-analysis">
                <h3>Analyse du prix</h3>
                <p>√Ä {product.price}, le {product.name} se positionne dans le segment premium mais reste comp√©titif compte tenu de son efficacit√© prouv√©e et de sa formulation exclusive.</p>
                
                {product.originalPrice && (
                  <div class="price-savings">
                    <p><strong>√âconomie actuelle :</strong> {product.discount}% de r√©duction (prix normal : {product.originalPrice})</p>
                  </div>
                )}
              </div>
            </section>
          </article>

          <!-- Sidebar -->
          <aside class="sidebar-content">
            <!-- Produit en vedette -->
            <div class="sidebar-product">
              <h3>Acheter Maintenant</h3>
              <AffiliateProduct 
                productId={product.id}
                placement="sidebar"
                variant="compact"
                className="sidebar-cta-product"
                showIfRelevant={false}
              />
            </div>

            <!-- FAQ rapide -->
            <div class="quick-faq">
              <h3>‚ùì Questions Fr√©quentes</h3>
              <div class="faq-item">
                <h4>Est-ce adapt√© pendant un traitement GLP-1 ?</h4>
                <p>Oui, sp√©cialement formul√© pour accompagner la perte de poids.</p>
              </div>
              <div class="faq-item">
                <h4>Combien de temps pour voir des r√©sultats ?</h4>
                <p>Les premiers effets sont visibles d√®s 4 semaines d'utilisation r√©guli√®re.</p>
              </div>
            </div>

            <!-- Articles li√©s -->
            <div class="related-articles">
              <h3>üìö Articles Li√©s</h3>
              <ul>
                <li><a href="/glp1-perte-de-poids/peau-relachee-apres-perte-de-poids/">Peau rel√¢ch√©e apr√®s perte de poids</a></li>
                <li><a href="/effets-secondaires-glp1/effets-sur-la-peau/">Effets des GLP-1 sur la peau</a></li>
                <li><a href="/guide-beaute-perte-de-poids-glp1/">Guide beaut√© et GLP-1</a></li>
              </ul>
            </div>
          </aside>
        </div>
      </main>
    </div>
  </div>

  <!-- Schema.org structured data pour SEO -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Review",
    "itemReviewed": {
      "@type": "Product",
      "name": product.name,
      "brand": {
        "@type": "Brand",
        "name": product.brand
      },
      "description": product.description,
      "image": product.image,
      "offers": {
        "@type": "Offer",
        "price": product.price.replace(/[‚Ç¨$¬£]/g, ''),
        "priceCurrency": "EUR",
        "availability": "https://schema.org/InStock"
      }
    },
    "reviewRating": {
      "@type": "Rating",
      "ratingValue": product.rating,
      "bestRating": 5
    },
    "author": {
      "@type": "Organization",
      "name": "GLP-1 France"
    },
    "publisher": {
      "@type": "Organization",
      "name": "GLP-1 France"
    },
    "datePublished": "2025-08-12",
    "reviewBody": `Test complet du ${product.name} : efficacit√© prouv√©e pour accompagner la perte de poids sous traitement GLP-1.`
  })}></script>
</BaseLayout>

<style>
  .product-review-page {
    min-height: 100vh;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  /* Hero Section */
  .product-hero {
    display: grid;
    grid-template-columns: 1fr 350px;
    gap: 3rem;
    padding: 3rem 0;
    margin-bottom: 3rem;
  }

  .hero-breadcrumb {
    font-size: 0.875rem;
    color: #64748b;
    margin-bottom: 1rem;
  }

  .hero-breadcrumb a {
    color: #2563eb;
    text-decoration: none;
  }

  .hero-title {
    font-size: 2.5rem;
    font-weight: 800;
    color: #1e293b;
    line-height: 1.2;
    margin-bottom: 1rem;
  }

  .hero-subtitle {
    font-size: 1.25rem;
    color: #475569;
    margin-bottom: 2rem;
    line-height: 1.6;
  }

  .hero-rating {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .rating-stars {
    display: flex;
    gap: 0.25rem;
  }

  .star {
    color: #d1d5db;
    font-size: 1.25rem;
  }

  .star.filled {
    color: #fbbf24;
  }

  .rating-text {
    color: #64748b;
    font-weight: 500;
  }

  /* Contenu principal */
  .content-grid {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 3rem;
    margin-bottom: 3rem;
  }

  .main-content {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .main-content h2 {
    font-size: 1.875rem;
    font-weight: 700;
    color: #1e293b;
    margin: 2rem 0 1rem 0;
    border-bottom: 3px solid #2563eb;
    padding-bottom: 0.5rem;
  }

  .main-content h3 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #374151;
    margin: 1.5rem 0 0.75rem 0;
  }

  /* Verdict Box */
  .verdict-box {
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
    border: 2px solid #3b82f6;
    border-radius: 12px;
    padding: 2rem;
    display: flex;
    gap: 2rem;
    align-items: center;
    margin-bottom: 2rem;
  }

  .verdict-score {
    text-align: center;
    min-width: 100px;
  }

  .score-number {
    display: block;
    font-size: 2.5rem;
    font-weight: 800;
    color: #1d4ed8;
  }

  .score-label {
    font-weight: 600;
    color: #1e40af;
  }

  /* Grille de b√©n√©fices */
  .benefits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin: 1.5rem 0;
  }

  .benefit-card {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1.5rem;
  }

  .benefit-card h4 {
    color: #059669;
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  /* Timeline */
  .test-timeline {
    margin: 1.5rem 0;
  }

  .timeline-item {
    border-left: 3px solid #3b82f6;
    padding-left: 1.5rem;
    margin-bottom: 2rem;
    position: relative;
  }

  .timeline-item::before {
    content: '';
    position: absolute;
    left: -8px;
    top: 0;
    width: 12px;
    height: 12px;
    background: #3b82f6;
    border-radius: 50%;
  }

  .timeline-item h4 {
    color: #1e293b;
    margin-bottom: 0.5rem;
    font-weight: 600;
  }

  /* Tableau de comparaison */
  .comparison-table {
    overflow-x: auto;
    margin: 1.5rem 0;
  }

  .comparison-table table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .comparison-table th,
  .comparison-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #e2e8f0;
  }

  .comparison-table th {
    background: #f1f5f9;
    font-weight: 600;
    color: #1e293b;
  }

  .comparison-table .highlight {
    background: #dbeafe;
    font-weight: 600;
    color: #1d4ed8;
  }

  /* Guide d'utilisation */
  .usage-guide ol {
    padding-left: 1.5rem;
    margin: 1rem 0;
  }

  .usage-guide li {
    margin-bottom: 0.5rem;
    line-height: 1.6;
  }

  .usage-tips {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: 8px;
    padding: 1.5rem;
    margin: 1.5rem 0;
  }

  .usage-tips h4 {
    color: #92400e;
    margin-bottom: 1rem;
  }

  .usage-tips ul {
    list-style: none;
    padding: 0;
  }

  .usage-tips li {
    margin-bottom: 0.5rem;
    padding-left: 1.5rem;
    position: relative;
  }

  .usage-tips li::before {
    content: 'üí°';
    position: absolute;
    left: 0;
  }

  /* Sidebar */
  .sidebar-content {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .sidebar-product,
  .quick-faq,
  .related-articles {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .sidebar-content h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 1rem;
  }

  .faq-item {
    margin-bottom: 1.5rem;
  }

  .faq-item h4 {
    font-size: 0.875rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .faq-item p {
    font-size: 0.875rem;
    color: #64748b;
    line-height: 1.5;
  }

  .related-articles ul {
    list-style: none;
    padding: 0;
  }

  .related-articles li {
    margin-bottom: 0.75rem;
  }

  .related-articles a {
    color: #2563eb;
    text-decoration: none;
    font-size: 0.875rem;
    line-height: 1.5;
  }

  .related-articles a:hover {
    text-decoration: underline;
  }

  /* Prix */
  .price-analysis {
    background: #f0fdf4;
    border: 1px solid #22c55e;
    border-radius: 8px;
    padding: 1.5rem;
    margin: 1.5rem 0;
  }

  .price-savings {
    background: #dc2626;
    color: white;
    padding: 1rem;
    border-radius: 6px;
    margin-top: 1rem;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .product-hero {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .content-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
  }

  @media (max-width: 768px) {
    .hero-title {
      font-size: 2rem;
    }

    .verdict-box {
      flex-direction: column;
      text-align: center;
    }

    .benefits-grid {
      grid-template-columns: 1fr;
    }

    .main-content,
    .sidebar-product,
    .quick-faq,
    .related-articles {
      padding: 1rem;
    }
  }
</style>
